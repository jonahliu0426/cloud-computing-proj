{"ast":null,"code":"var _jsxFileName = \"/Users/jia78/Desktop/nyu-mscs/9223-cloud-computing/cloud-computing-proj/cloud-computing-proj/src/components/shared/OptionsDialog.js\";\nimport { Button, Dialog, Divider } from \"@material-ui/core\";\nimport React from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport { useOptionsDialogStyles } from \"../../styles\";\nimport { UserContext } from \"../../App\";\nimport AuthProvider from \"../../auth\";\nimport { DELETE_POST, UNFOLLOW_USER } from \"../../graphql/mutations\";\nimport { useMutation } from \"@apollo/client\";\n\nfunction OptionsDialog({\n  onClose,\n  authorId,\n  postId\n}) {\n  const classes = useOptionsDialogStyles();\n  const {\n    currentUserId,\n    followingIds\n  } = React.useContext(UserContext);\n  const isOwner = currentUserId === authorId;\n  const buttonText = isOwner ? \"Delete\" : \"Unfollow\";\n  const onClick = isOwner ? handleDeletePost : handleUnfollowUser;\n  const isFollowing = followingIds.some(id => id === authorId);\n  const isUnrelatedUser = !isOwner && !isFollowing;\n  const [unfollowUser] = useMutation(UNFOLLOW_USER);\n  const [deletePost] = useMutation(DELETE_POST);\n  const history = useHistory();\n\n  async function handleDeletePost() {\n    const variables = {\n      postId,\n      userId: currentUserId\n    };\n    await deletePost({\n      variables\n    });\n    onClose(); // setTimeout(() => history.push('/'), 0);\n\n    history.push('/');\n    window.location.reload();\n  }\n\n  function handleUnfollowUser() {\n    const variables = {\n      userIdToUnfollow: authorId,\n      currentUserId\n    };\n    unfollowUser({\n      variables\n    });\n    onClose();\n  }\n\n  return React.createElement(Dialog, {\n    open: true,\n    classes: {\n      scrollPaper: classes.dialogScrollPaper\n    },\n    onClose: onClose,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45\n    },\n    __self: this\n  }, !isUnrelatedUser && React.createElement(Button, {\n    onClick: onClick,\n    className: classes.redButton,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  }, buttonText), React.createElement(Divider, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  }), React.createElement(Button, {\n    className: classes.button,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  }, React.createElement(Link, {\n    to: `/p/${postId}`,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, \"Go to post\")), React.createElement(Divider, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }), React.createElement(Button, {\n    className: classes.button,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }, \"Share\"), React.createElement(Divider, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }), React.createElement(Button, {\n    className: classes.button,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }, \"Copy Link\"), React.createElement(Divider, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }), React.createElement(Button, {\n    className: classes.button,\n    onClick: onClose,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }, \"Cancel\"));\n}\n\nexport default OptionsDialog;","map":{"version":3,"sources":["/Users/jia78/Desktop/nyu-mscs/9223-cloud-computing/cloud-computing-proj/cloud-computing-proj/src/components/shared/OptionsDialog.js"],"names":["Button","Dialog","Divider","React","Link","useHistory","useOptionsDialogStyles","UserContext","AuthProvider","DELETE_POST","UNFOLLOW_USER","useMutation","OptionsDialog","onClose","authorId","postId","classes","currentUserId","followingIds","useContext","isOwner","buttonText","onClick","handleDeletePost","handleUnfollowUser","isFollowing","some","id","isUnrelatedUser","unfollowUser","deletePost","history","variables","userId","push","window","location","reload","userIdToUnfollow","scrollPaper","dialogScrollPaper","redButton","button"],"mappings":"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","sourcesContent":["import { Button, Dialog, Divider } from \"@material-ui/core\";\nimport React from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport { useOptionsDialogStyles } from \"../../styles\";\nimport { UserContext } from \"../../App\";\nimport AuthProvider from \"../../auth\";\nimport { DELETE_POST, UNFOLLOW_USER } from \"../../graphql/mutations\";\nimport { useMutation } from \"@apollo/client\";\n\nfunction OptionsDialog({ onClose, authorId, postId }) {\n  const classes = useOptionsDialogStyles();\n  const { currentUserId, followingIds } = React.useContext(UserContext);\n  const isOwner = currentUserId === authorId;\n  const buttonText = isOwner ? \"Delete\" : \"Unfollow\";\n  const onClick = isOwner ? handleDeletePost : handleUnfollowUser;\n  const isFollowing = followingIds.some(id => id === authorId);\n  const isUnrelatedUser = !isOwner && !isFollowing;\n  const [unfollowUser] = useMutation(UNFOLLOW_USER);\n  const [deletePost] = useMutation(DELETE_POST);\n  const history = useHistory();\n\n\n  async function handleDeletePost() {\n    const variables = {\n      postId,\n      userId: currentUserId\n    }\n    await deletePost({ variables });\n    onClose();\n    // setTimeout(() => history.push('/'), 0);\n    history.push('/');\n    window.location.reload();\n  }\n\n  function handleUnfollowUser() {\n    const variables = {\n      userIdToUnfollow: authorId,\n      currentUserId\n    }\n    unfollowUser({ variables });\n    onClose();\n  }\n\n  return (\n    <Dialog\n      open\n      classes={{\n        scrollPaper: classes.dialogScrollPaper\n      }}\n      onClose={onClose}\n    >\n      {!isUnrelatedUser && <Button onClick={onClick} className={classes.redButton}>\n        {buttonText}\n      </Button>}\n      <Divider />\n      <Button className={classes.button}>\n        <Link to={`/p/${postId}`}>Go to post</Link>\n      </Button>\n      <Divider />\n      <Button className={classes.button}>\n        Share\n      </Button>\n      <Divider />\n      <Button className={classes.button}>\n        Copy Link\n      </Button>\n      <Divider />\n      <Button className={classes.button} onClick={onClose} >\n        Cancel\n      </Button>\n    </Dialog >\n  )\n}\n\nexport default OptionsDialog;\n"]},"metadata":{},"sourceType":"module"}